#!/usr/bin/env bash
set -e

echo "Linking dotfiles..."

for file in gitconfig gitignore zshrc zshrc.d
do
    fullpath=`realpath $file`
    rm -rf "$HOME/.$file"
    ln -s $fullpath "$HOME/.$file"
done

# Karabiner.
echo "Linking Karabiner..."
mkdir -p $HOME/.config/karabiner/assets

karabiner_config=`realpath config/karabiner/assets/complex_modifications`
rm $HOME/.config/karabiner/assets/complex_modifications
ln -s $karabiner_config $HOME/.config/karabiner/assets/complex_modifications

# VS Code
echo "Configuring VS Code..."
vscode_config_dest="$HOME/Library/Application Support/Code/User/settings.json"

if [[ -f "$vscode_config_dest" ]]; then
    rm "$vscode_config_dest"
fi

ln -s `realpath config/code/User/settings.json` "$vscode_config_dest"
./scripts/vscode

exit

# Scripts
echo "Setting macOS defaults..."
./scripts/osx-better-defaults

echo "Finished!"
